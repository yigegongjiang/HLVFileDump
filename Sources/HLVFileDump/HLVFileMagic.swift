//
//  File.swift
//  
//
//  Created by gebiwanger on 2023/12/23.
//

import Foundation

public enum HLVFileType {
  case magic(name:String, alias: [String]?, hex: [UInt8])
  case unknow
  case error(_ msg: String)
}

public class HLVFileMagic {

  var allFilesMark: [HLVFileType] = []
  
  public static var `default`: HLVFileMagic { HLVFileMagic() }
  
  // 根据 magic number 识别当前文件类型
  public func dump(_ path: String) -> HLVFileType {
    guard let pathUrl = hlvFileExistCheck(path) else {
      return HLVFileType.error("cannot find target file.")
    }
    
    guard let filehandle = try? FileHandle(forReadingFrom: pathUrl) else {
      return HLVFileType.error("target file cannot read.")
    }
    
    defer {
      try? filehandle.close()
    }
    
    // 根据 magic 遍历已知类型
    let headerLength = 8
    let headerData = filehandle.readData(ofLength: headerLength)
    
    for m in allFilesMark {
      if case let .magic(_, _, hex) = m {
        let header = headerData.prefix(hex.count)
        if header.elementsEqual(hex) {
          return m
        }
      }
    }
    
    // 确认是否为文本类型
    if HLVFile.isText(path) {
      return HLVFileType.magic(name: "text", alias: nil, hex: [])
    }
    
    return HLVFileType.unknow
  }
  
  public init() {
    allFilesMark.append(HLVFileType.magic(name:"7z", alias: nil, hex: [0x37,0x7A,0xBC,0xAF,0x27,0x1C]))
    allFilesMark.append(HLVFileType.magic(name:"aba", alias: nil, hex: [0x00,0x01,0x42,0x41]))
    allFilesMark.append(HLVFileType.magic(name:"abi", alias: nil, hex: [0x41,0x4F,0x4C,0x49,0x4E,0x44,0x45,0x58]))
    allFilesMark.append(HLVFileType.magic(name:"accdb", alias: nil, hex: [0x00,0x01,0x00,0x00,0x53,0x74,0x61,0x6E,0x64,0x61,0x72,0x64,0x20,0x41,0x43,0x45,0x20,0x44,0x42]))
    allFilesMark.append(HLVFileType.magic(name:"ACM", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"ADF", alias: nil, hex: [0x44,0x4F,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"adx", alias: nil, hex: [0x03,0x00,0x00,0x00,0x41,0x50,0x50,0x52]))
    allFilesMark.append(HLVFileType.magic(name:"AIFF", alias: nil, hex: [0x46,0x4F,0x52,0x4D,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"ain", alias: nil, hex: [0x21,0x12]))
    allFilesMark.append(HLVFileType.magic(name:"ami", alias: nil, hex: [0x5B,0x76,0x65,0x72,0x5D]))
    allFilesMark.append(HLVFileType.magic(name:"amr", alias: nil, hex: [0x23,0x21,0x41,0x4D,0x52]))
    allFilesMark.append(HLVFileType.magic(name:"ANI", alias: nil, hex: [0x52,0x49,0x46,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"API", alias: nil, hex: [0x4D,0x5A,0x90,0x00,0x03,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"arc", alias: nil, hex: [0x41,0x72,0x43,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"arj", alias: nil, hex: [0x60,0xEA]))
    allFilesMark.append(HLVFileType.magic(name:"ARJ", alias: nil, hex: [0x60,0xEA,0x27]))
    allFilesMark.append(HLVFileType.magic(name:"ART", alias: nil, hex: [0x4A,0x47,0x03,0x0E,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"ART", alias: nil, hex: [0x4A,0x47,0x04,0x0E,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"asf", alias: nil, hex: [0x30,0x26,0xB2,0x75,0x8E,0x66,0xCF,0x11]))
    allFilesMark.append(HLVFileType.magic(name:"asx", alias: nil, hex: [0x3C]))
    allFilesMark.append(HLVFileType.magic(name:"au", alias: nil, hex: [0x2E,0x73,0x6E,0x64]))
    allFilesMark.append(HLVFileType.magic(name:"avi", alias: nil, hex: [0x41,0x56,0x49,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"AX", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"AX", alias: nil, hex: [0x4D,0x5A,0x90,0x00,0x03,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"bag", alias: nil, hex: [0x41,0x4F,0x4C,0x20,0x46,0x65,0x65,0x64,0x62,0x61,0x67]))
    allFilesMark.append(HLVFileType.magic(name:"BAS", alias: nil, hex: [0x20,0x20,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"bin", alias: nil, hex: [0x42,0x4C,0x49,0x32,0x32,0x33,0x51]))
    allFilesMark.append(HLVFileType.magic(name:"bmp", alias: nil, hex: [0x42,0x4D]))
    allFilesMark.append(HLVFileType.magic(name:"BMP", alias: nil, hex: [0x42,0x4D,0x3E]))
    allFilesMark.append(HLVFileType.magic(name:"CAB", alias: nil, hex: [0x49,0x53,0x63]))
    allFilesMark.append(HLVFileType.magic(name:"CAB", alias: nil, hex: [0x4D,0x53,0x43,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"cat", alias: nil, hex: [0x30]))
    allFilesMark.append(HLVFileType.magic(name:"CBD", alias: nil, hex: [0x43,0x42,0x46,0x49,0x4C,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"CCD", alias: nil, hex: [0x5B,0x43,0x6C]))
    allFilesMark.append(HLVFileType.magic(name:"CDR", alias: nil, hex: [0x45,0x4C,0x49,0x54,0x45,0x20,0x43,0x6F,0x6D,0x6D,0x61,0x6E,0x64,0x65,0x72,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"CHM", alias: nil, hex: [0x49,0x54,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"CLB", alias: nil, hex: [0x43,0x4D,0x58,0x31]))
    allFilesMark.append(HLVFileType.magic(name:"CLB", alias: nil, hex: [0x43,0x4F,0x4D,0x2B]))
    allFilesMark.append(HLVFileType.magic(name:"cnt", alias: nil, hex: [0x3A,0x42,0x61,0x73,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"COM", alias: nil, hex: [0x4D,0x5A,0xEE]))
    allFilesMark.append(HLVFileType.magic(name:"COM", alias: nil, hex: [0xE9,0x3B,0x03]))
    allFilesMark.append(HLVFileType.magic(name:"CPE", alias: nil, hex: [0x46,0x41,0x58,0x43,0x4F,0x56,0x45,0x52,0x2D,0x56,0x45,0x52]))
    allFilesMark.append(HLVFileType.magic(name:"CPL", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"CPT", alias: nil, hex: [0x43,0x50,0x54,0x37,0x46,0x49,0x4C,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"CPT", alias: nil, hex: [0x43,0x50,0x54,0x46,0x49,0x4C,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"CPX", alias: nil, hex: [0x5B,0x57,0x69]))
    allFilesMark.append(HLVFileType.magic(name:"CRU", alias: nil, hex: [0x43,0x52,0x55,0x53,0x48,0x20,0x76]))
    allFilesMark.append(HLVFileType.magic(name:"CRW", alias: nil, hex: [0x49,0x49,0x1A,0x00,0x00,0x00,0x48,0x45,0x41,0x50,0x43,0x43,0x44,0x52,0x02,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"CTF", alias: nil, hex: [0x43,0x61,0x74,0x61,0x6C,0x6F,0x67,0x20,0x33,0x2E,0x30,0x30,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"CUR", alias: nil, hex: [0x00,0x00,0x02,0x00,0x01,0x00,0x20,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"dat", alias: nil, hex: [0x03]))
    allFilesMark.append(HLVFileType.magic(name:"dat", alias: nil, hex: [0x1A,0x52,0x54,0x53,0x20,0x43,0x4F,0x4D,0x50,0x52,0x45,0x53,0x53,0x45,0x44,0x20,0x49,0x4D,0x41,0x47,0x45,0x20,0x56,0x31,0x2E,0x30,0x1A]))
    allFilesMark.append(HLVFileType.magic(name:"dat", alias: nil, hex: [0x41,0x56,0x47,0x36,0x5F,0x49,0x6E,0x74,0x65,0x67,0x72,0x69,0x74,0x79,0x5F,0x44,0x61,0x74,0x61,0x62,0x61,0x73,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"DAT", alias: nil, hex: [0x43,0x52,0x45,0x47]))
    allFilesMark.append(HLVFileType.magic(name:"DAT", alias: nil, hex: [0x43,0x6C,0x69,0x65,0x6E,0x74,0x20,0x55,0x72,0x6C,0x43,0x61,0x63,0x68,0x65,0x20,0x4D,0x4D,0x46,0x20,0x56,0x65,0x72,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"DAT", alias: nil, hex: [0x45,0x52,0x46,0x53,0x53,0x41,0x56,0x45,0x44,0x41,0x54,0x41,0x46,0x49,0x4C,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"DAT", alias: nil, hex: [0x49,0x6E,0x6E,0x6F,0x20,0x53,0x65,0x74,0x75,0x70,0x20,0x55,0x6E,0x69,0x6E,0x73,0x74,0x61,0x6C,0x6C,0x20,0x4C,0x6F,0x67,0x20,0x28,0x62,0x29]))
    allFilesMark.append(HLVFileType.magic(name:"db", alias: nil, hex: [0x00,0x06,0x15,0x61,0x00,0x00,0x00,0x02,0x00,0x00,0x04,0xD2,0x00,0x00,0x10,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"DB", alias: nil, hex: [0x44,0x42,0x46,0x48]))
    allFilesMark.append(HLVFileType.magic(name:"db", alias: nil, hex: [0x08]))
    allFilesMark.append(HLVFileType.magic(name:"db3", alias: nil, hex: [0x03]))
    allFilesMark.append(HLVFileType.magic(name:"db4", alias: nil, hex: [0x04]))
    allFilesMark.append(HLVFileType.magic(name:"dba", alias: nil, hex: [0x00,0x01,0x42,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"dbx", alias: nil, hex: [0xCF,0xAD,0x12,0xFE]))
    allFilesMark.append(HLVFileType.magic(name:"dbx", alias: nil, hex: [0xCF,0xAD,0x12,0xFE,0xC5,0xFD,0x74,0x6F]))
    allFilesMark.append(HLVFileType.magic(name:"dci", alias: nil, hex: [0x3C,0x21,0x64,0x6F,0x63,0x74,0x79,0x70]))
    allFilesMark.append(HLVFileType.magic(name:"dcx", alias: nil, hex: [0x3A,0xDE,0x68,0xB1]))
    allFilesMark.append(HLVFileType.magic(name:"DDB", alias: nil, hex: [0x00,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"dib", alias: nil, hex: [0x42,0x4D]))
    allFilesMark.append(HLVFileType.magic(name:"DLL", alias: nil, hex: [0x4D,0x5A,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"DMP", alias: nil, hex: [0x4D,0x44,0x4D,0x50,0x93,0xA7]))
    allFilesMark.append(HLVFileType.magic(name:"DMS", alias: nil, hex: [0x44,0x4D,0x53,0x21]))
    allFilesMark.append(HLVFileType.magic(name:"doc", alias: nil, hex: [0x0D,0x44,0x4F,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"doc", alias: nil, hex: [0x12,0x34,0x56,0x78,0x90,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"doc", alias: nil, hex: [0x31,0xBE,0x00,0x00,0x00,0xAB,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"doc", alias: nil, hex: [0x7F,0xFE,0x34,0x0A]))
    allFilesMark.append(HLVFileType.magic(name:"DPL", alias: nil, hex: [0x4D,0x5A,0x50]))
    allFilesMark.append(HLVFileType.magic(name:"DRV", alias: nil, hex: [0x4D,0x5A,0x16]))
    allFilesMark.append(HLVFileType.magic(name:"drw", alias: nil, hex: [0x07]))
    allFilesMark.append(HLVFileType.magic(name:"drw", alias: nil, hex: [0x01,0xFF,0x02,0x04,0x03,0x02]))
    allFilesMark.append(HLVFileType.magic(name:"ds4", alias: nil, hex: [0x4D,0x47,0x58,0x20,0x69,0x74,0x70,0x64]))
    allFilesMark.append(HLVFileType.magic(name:"DSN", alias: nil, hex: [0x4D,0x56]))
    allFilesMark.append(HLVFileType.magic(name:"dss", alias: nil, hex: [0x02,0x64,0x73,0x73]))
    allFilesMark.append(HLVFileType.magic(name:"dtd", alias: nil, hex: [0x07,0x64,0x74,0x32,0x64,0x64,0x74,0x64]))
    allFilesMark.append(HLVFileType.magic(name:"dtd", alias: nil, hex: [0x3C,0x21,0x45,0x4E,0x54,0x49,0x54,0x59]))
    allFilesMark.append(HLVFileType.magic(name:"DVR", alias: nil, hex: [0x44,0x56,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"dwg", alias: nil, hex: [0x41,0x43,0x31]))
    allFilesMark.append(HLVFileType.magic(name:"ECO", alias: nil, hex: [0x2A,0x50,0x52]))
    allFilesMark.append(HLVFileType.magic(name:"elf", alias: nil, hex: [0x7F,0x45,0x4C,0x46,0x01,0x01,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"emf", alias: nil, hex: [0x01,0x00,0x00,0x00,0x58,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"eml", alias: nil, hex: [0x44,0x65,0x6C,0x69,0x76,0x65,0x72,0x79,0x2D,0x64,0x61,0x74,0x65,0x3A]))
    allFilesMark.append(HLVFileType.magic(name:"EML", alias: nil, hex: [0x46,0x72,0x6F,0x6D,0x20,0x20,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"EML", alias: nil, hex: [0x46,0x72,0x6F,0x6D,0x20,0x3F,0x3F,0x3F]))
    allFilesMark.append(HLVFileType.magic(name:"EML", alias: nil, hex: [0x46,0x72,0x6F,0x6D,0x3A,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"EML", alias: nil, hex: [0x52,0x65,0x63]))
    allFilesMark.append(HLVFileType.magic(name:"enc", alias: nil, hex: [0x00,0x5C,0x41,0xB1,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"eps", alias: nil, hex: [0x25,0x21,0x50,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"eps", alias: nil, hex: [0x25,0x21,0x50,0x53,0x2D,0x41,0x64,0x6F,0x62,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"eps", alias: nil, hex: [0x25,0x21,0x50,0x53,0x2D,0x41,0x64,0x6F,0x62,0x65,0x2D,0x33,0x2E,0x30,0x20,0x45,0x50,0x53,0x46,0x2D,0x33,0x20,0x30]))
    allFilesMark.append(HLVFileType.magic(name:"EPS", alias: nil, hex: [0xC5,0xD0,0xD3]))
    allFilesMark.append(HLVFileType.magic(name:"eth", alias: nil, hex: [0x1A,0x35,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"evt", alias: nil, hex: [0x30,0x00,0x00,0x00,0x4C,0x66,0x4C,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"evt", alias: nil, hex: [0x03,0x00,0x00,0x00,0xC4,0x66,0xC4,0x56]))
    allFilesMark.append(HLVFileType.magic(name:"EVTX", alias: nil, hex: [0x45,0x6C,0x66,0x46,0x69,0x6C,0x65,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"fli", alias: nil, hex: [0x00,0x11,0xAF]))
    allFilesMark.append(HLVFileType.magic(name:"flt", alias: nil, hex: [0x00,0x01,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"FLT", alias: nil, hex: [0x4D,0x5A,0x90,0x00,0x03,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"FLV", alias: nil, hex: [0x46,0x4C,0x56,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"fm", alias: nil, hex: [0x3C,0x4D,0x61,0x6B,0x65,0x72,0x46,0x69,0x6C,0x65,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"fm3", alias: nil, hex: [0x00,0x00,0x1A,0x00,0x07,0x80,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"fmt", alias: nil, hex: [0x20,0x00,0x68,0x00,0x20,0]))
    allFilesMark.append(HLVFileType.magic(name:"FNT", alias: nil, hex: [0x43,0x48,0x41]))
    allFilesMark.append(HLVFileType.magic(name:"FON", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"GBC", alias: nil, hex: [0x87,0xF5,0x3E]))
    allFilesMark.append(HLVFileType.magic(name:"gid", alias: nil, hex: [0x3F,0x5F,0x03,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"GID", alias: nil, hex: [0x4C,0x4E,0x02,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"GIF", alias: nil, hex: [0x47,0x49,0x46,0x38]))
    allFilesMark.append(HLVFileType.magic(name:"gif", alias: nil, hex: [0x47,0x49,0x46,0x38,0x37,0x61]))
    allFilesMark.append(HLVFileType.magic(name:"gif", alias: nil, hex: [0x47,0x49,0x46,0x38,0x39,0x61]))
    allFilesMark.append(HLVFileType.magic(name:"GTD", alias: nil, hex: [0x7B,0x50,0x72]))
    allFilesMark.append(HLVFileType.magic(name:"GX2", alias: nil, hex: [0x47,0x58,0x32]))
    allFilesMark.append(HLVFileType.magic(name:"hap", alias: nil, hex: [0x91,0x33,0x48,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"HDMP", alias: nil, hex: [0x4D,0x44,0x4D,0x50,0x93,0xA7]))
    allFilesMark.append(HLVFileType.magic(name:"hdr", alias: nil, hex: [0x23,0x3F,0x52,0x41,0x44,0x49,0x41,0x4E,0x43,0x45,0x0A]))
    allFilesMark.append(HLVFileType.magic(name:"HLP", alias: nil, hex: [0x3F,0x5F,0x03]))
    allFilesMark.append(HLVFileType.magic(name:"hlp", alias: nil, hex: [0x3F,0x5F,0x03,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"HLP", alias: nil, hex: [0x4C,0x4E,0x02,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"hqx", alias: nil, hex: [0x28,0x54,0x68,0x69,0x73,0x20,0x66,0x69,0x6C,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"hqx", alias: nil, hex: [0x28,0x54,0x68,0x69,0x73,0x20,0x66,0x69,0x6C,0x65,0x20,0x6D,0x75,0x73,0x74,0x20,0x62,0x65,0x20,0x63,0x6F,0x6E,0x76,0x65,0x72,0x74,0x65,0x64,0x20,0x77,0x69,0x74,0x68,0x20,0x42,0x69,0x6E,0x48,0x65,0x78,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"HTM", alias: nil, hex: [0x3C,0x21,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"html", alias: nil, hex: [0x68,0x74,0x6D,0x6C,0x3E]))
    allFilesMark.append(HLVFileType.magic(name:"ico", alias: nil, hex: [0x00,0x00,0x01,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"ico", alias: nil, hex: [0x00,0x00,0x01,0x00,0x01,0x00,0x20,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"IFF", alias: nil, hex: [0x46,0x4F,0x52,0x4D]))
    allFilesMark.append(HLVFileType.magic(name:"IFO", alias: nil, hex: [0x44,0x56,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"IME", alias: nil, hex: [0x4D,0x5A,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"img", alias: nil, hex: [0x00,0x01,0x00,0x08,0x00,0x01,0x00,0x01,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"IMG", alias: nil, hex: [0x00,0xFF,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"IMM", alias: nil, hex: [0x4D,0x5A,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"ind", alias: nil, hex: [0x41,0x4F,0x4C,0x49,0x44,0x58]))
    allFilesMark.append(HLVFileType.magic(name:"ISO", alias: nil, hex: [0x43,0x44,0x30,0x30,0x31]))
    allFilesMark.append(HLVFileType.magic(name:"ivr", alias: nil, hex: [0x2E,0x52,0x45,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"JAR", alias: nil, hex: [0x4A,0x41,0x52,0x43,0x53,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"jar", alias: nil, hex: [0x5F,0x27,0xA8,0x89]))
    allFilesMark.append(HLVFileType.magic(name:"KGB", alias: nil, hex: [0x4B,0x47,0x42,0x5F,0x61,0x72,0x63,0x68,0x20,0x2D]))
    allFilesMark.append(HLVFileType.magic(name:"KOZ", alias: nil, hex: [0x49,0x44,0x33,0x03,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"LDB", alias: nil, hex: [0x42,0x49,0x4C]))
    allFilesMark.append(HLVFileType.magic(name:"lha", alias: nil, hex: [0x2D,0x6C,0x68,0x35,0x2D]))
    allFilesMark.append(HLVFileType.magic(name:"LHP", alias: nil, hex: [0x3F,0x5F,0x03]))
    allFilesMark.append(HLVFileType.magic(name:"lhp", alias: nil, hex: [0x3F,0x5F,0x03,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"lib", alias: nil, hex: [0x21,0x3C,0x61,0x72,0x63,0x68,0x3E,0x0A]))
    allFilesMark.append(HLVFileType.magic(name:"LIB", alias: nil, hex: [0x2A,0x24,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"LIT", alias: nil, hex: [0x49,0x54,0x4F,0x4C,0x49,0x54,0x4C,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"LNK", alias: nil, hex: [0x4C,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"lnk", alias: nil, hex: [0x4C,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"lnk", alias: nil, hex: [0x4C,0x00,0x00,0x00,0x01,0x14,0x02]))
    allFilesMark.append(HLVFileType.magic(name:"LNK", alias: nil, hex: [0x4C,0x00,0x00,0x00,0x01,0x14,0x02,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"log", alias: nil, hex: [0x2A,0x2A,0x2A,0x20,0x20,0x49,0x6E,0x73,0x74,0x61,0x6C,0x6C,0x61,0x74,0x69,0x6F,0x6E,0x20,0x53,0x74,0x61,0x72,0x74,0x65,0x64,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"lwp", alias: nil, hex: [0x57,0x6F,0x72,0x64,0x50,0x72,0x6F]))
    allFilesMark.append(HLVFileType.magic(name:"m3u", alias: nil, hex: [0x23,0x45,0x58]))
    allFilesMark.append(HLVFileType.magic(name:"m4a", alias: nil, hex: [0x00,0x00,0x00,0x20,0x66,0x74,0x79,0x70,0x4D,0x34,0x41,0x20,0x00,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"manifest", alias: nil, hex: [0x3C,0x3F,0x78,0x6D,0x6C,0x20,0x76,0x65,0x72,0x73,0x69,0x6F,0x6E,0x3D]))
    allFilesMark.append(HLVFileType.magic(name:"MAR", alias: nil, hex: [0x4D,0x41,0x52,0x31,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"MAR", alias: nil, hex: [0x4D,0x41,0x52,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"MAR", alias: nil, hex: [0x4D,0x41,0x72,0x30,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"max", alias: nil, hex: [0xD0,0xCF,0x11]))
    allFilesMark.append(HLVFileType.magic(name:"mdb", alias: nil, hex: [0x00,0x01,0x00,0x00,0x53,0x74,0x61,0x6E,0x64,0x61,0x72,0x64,0x20,0x4A,0x65,0x74,0x20,0x44,0x42]))
    allFilesMark.append(HLVFileType.magic(name:"MDF", alias: nil, hex: [0x00,0xFF,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"mdf", alias: nil, hex: [0x00,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0x00,0x00,0x02,0x00,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"mdf", alias: nil, hex: [0x01,0x0F,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"MDI", alias: nil, hex: [0x45,0x50]))
    allFilesMark.append(HLVFileType.magic(name:"MDS", alias: nil, hex: [0x4D,0x45,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"mkv", alias: nil, hex: [0x1A,0x45,0xDF,0xA3,0x93,0x42,0x82,0x88,0x6D,0x61,0x74,0x72,0x6F,0x73,0x6B,0x61]))
    allFilesMark.append(HLVFileType.magic(name:"MLS", alias: nil, hex: [0x4D,0x49,0x4C,0x45,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"MLS", alias: nil, hex: [0x4D,0x4C,0x53,0x57]))
    allFilesMark.append(HLVFileType.magic(name:"MLS", alias: nil, hex: [0x4D,0x56,0x32,0x31,0x34]))
    allFilesMark.append(HLVFileType.magic(name:"MLS", alias: nil, hex: [0x4D,0x56,0x32,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"MMF", alias: nil, hex: [0x4D,0x4D,0x4D,0x44,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"mny", alias: nil, hex: [0x00,0x01,0x00,0x00,0x4D,0x53,0x49,0x53,0x41,0x4D,0x20,0x44,0x61,0x74,0x61,0x62,0x61,0x73,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"MOV", alias: nil, hex: [0x00,0x00,0x0F]))
    allFilesMark.append(HLVFileType.magic(name:"MOV", alias: nil, hex: [0x00,0x00,0x77]))
    allFilesMark.append(HLVFileType.magic(name:"mov", alias: nil, hex: [0x6D,0x6F,0x6F,0x76]))
    allFilesMark.append(HLVFileType.magic(name:"mov", alias: nil, hex: [0x6D,0x64,0x61,0x74]))
    allFilesMark.append(HLVFileType.magic(name:"mp", alias: nil, hex: [0x0C,0xED]))
    allFilesMark.append(HLVFileType.magic(name:"MP3", alias: nil, hex: [0x49,0x44,0x33]))
    allFilesMark.append(HLVFileType.magic(name:"MP3", alias: nil, hex: [0xFF,0xFB,0x50]))
    allFilesMark.append(HLVFileType.magic(name:"mp4", alias: nil, hex: [0x00,0x00,0x00,0x18,0x66,0x74,0x79,0x70,0x33,0x67,0x70,0x35]))
    allFilesMark.append(HLVFileType.magic(name:"MPA", alias: nil, hex: [0x00,0x00,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"mpg", alias: nil, hex: [0x00,0x00,0x01,0xBA]))
    allFilesMark.append(HLVFileType.magic(name:"MSC", alias: nil, hex: [0x3C,0x3F,0x78]))
    allFilesMark.append(HLVFileType.magic(name:"msc", alias: nil, hex: [0x3C,0x3F,0x78,0x6D,0x6C,0x20,0x76,0x65,0x72,0x73,0x69,0x6F,0x6E,0x3D,0x22,0x31,0x2E,0x30,0x22,0x3F,0x3E,0x0D,0x0A,0x3C,0x4D,0x4D,0x43,0x5F,0x43,0x6F,0x6E,0x73,0x6F,0x6C,0x65,0x46,0x69,0x6C,0x65,0x20,0x43,0x6F,0x6E,0x73,0x6F,0x6C,0x65,0x56,0x65,0x72,0x73,0x69,0x6F,0x6E,0x3D,0x22]))
    allFilesMark.append(HLVFileType.magic(name:"msi", alias: nil, hex: [0x23,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"MSV", alias: nil, hex: [0x4D,0x53,0x5F,0x56,0x4F,0x49,0x43,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"NES", alias: nil, hex: [0x4E,0x45,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"NLS", alias: nil, hex: [0xC2,0x20,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"nri", alias: nil, hex: [0x0E,0x4E,0x65,0x72,0x6F,0x49,0x53,0x4F]))
    allFilesMark.append(HLVFileType.magic(name:"ntf", alias: nil, hex: [0x1A,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"nsf", alias: nil, hex: [0x1A,0x00,0x00,0x03,0x00,0x00,0x11,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"nsf", alias: nil, hex: [0x1A,0x00,0x00,0x04,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"ntf", alias: nil, hex: [0x30,0x31,0x4F,0x52,0x44,0x4E,0x41,0x4E,0x43,0x45,0x20,0x53,0x55,0x52,0x56,0x45,0x59,0x20,0x20,0x20,0x20,0x20,0x20,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"obj", alias: nil, hex: [0x4C,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"OCX", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"OCX", alias: nil, hex: [0x4D,0x5A,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"OLB", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"OLB", alias: nil, hex: [0x4D,0x5A,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"pak", alias: nil, hex: [0x1A,0x0B]))
    allFilesMark.append(HLVFileType.magic(name:"PAT", alias: nil, hex: [0x47,0x46,0x31,0x50,0x41,0x54,0x43,0x48]))
    allFilesMark.append(HLVFileType.magic(name:"PAT", alias: nil, hex: [0x47,0x50,0x41,0x54]))
    allFilesMark.append(HLVFileType.magic(name:"PBK", alias: nil, hex: [0x5B,0x41,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"PCB", alias: nil, hex: [0x17,0xA1,0x50]))
    allFilesMark.append(HLVFileType.magic(name:"PCS", alias: nil, hex: [0x0A,0x05,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"pcx", alias: nil, hex: [0x0A,0x05,0x01,0x08]))
    allFilesMark.append(HLVFileType.magic(name:"PDF", alias: nil, hex: [0x25,0x50,0x44]))
    allFilesMark.append(HLVFileType.magic(name:"pdf", alias: nil, hex: [0x25,0x50,0x44,0x46,0x2D,0x31,0x2E]))
    allFilesMark.append(HLVFileType.magic(name:"PDG", alias: nil, hex: [0x48,0x48,0x02]))
    allFilesMark.append(HLVFileType.magic(name:"pf", alias: nil, hex: [0x11,0x00,0x00,0x00,0x53,0x43,0x43,0x41]))
    allFilesMark.append(HLVFileType.magic(name:"pic", alias: nil, hex: [0x01,0x00,0x00,0x00,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"PJT", alias: nil, hex: [0x00,0x00,0x07]))
    allFilesMark.append(HLVFileType.magic(name:"PLL", alias: nil, hex: [0x24,0x53,0x6F]))
    allFilesMark.append(HLVFileType.magic(name:"PNG", alias: nil, hex: [0x89,0x50,0x4E]))
    allFilesMark.append(HLVFileType.magic(name:"PNG", alias: nil, hex: [0x89,0x50,0x4E,0x47]))
    allFilesMark.append(HLVFileType.magic(name:"png", alias: nil, hex: [0x89,0x50,0x4E,0x47,0x0D,0x0A]))
    allFilesMark.append(HLVFileType.magic(name:"png", alias: nil, hex: [0x89,0x50,0x4E,0x47,0x0D,0x0A,0x1A,0x0A]))
    allFilesMark.append(HLVFileType.magic(name:"PPC", alias: nil, hex: [0x52,0x65,0x63]))
    allFilesMark.append(HLVFileType.magic(name:"PPT", alias: nil, hex: [0xD0,0xCF,0x11]))
    allFilesMark.append(HLVFileType.magic(name:"PPZ", alias: nil, hex: [0x4D,0x53,0x43,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"prc", alias: nil, hex: [0x42,0x4F,0x4F,0x4B,0x4D,0x4F,0x42,0x49]))
    allFilesMark.append(HLVFileType.magic(name:"PRG", alias: nil, hex: [0x23,0x44,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"ps", alias: nil, hex: [0x25,0x21,0x50,0x53,0x2D,0x41,0x64,0x6F,0x62,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"PSD", alias: nil, hex: [0x38,0x42,0x50]))
    allFilesMark.append(HLVFileType.magic(name:"psd", alias: nil, hex: [0x38,0x42,0x50,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"psp", alias: nil, hex: [0x7E,0x42,0x4B,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"pst", alias: nil, hex: [0x21,0x42,0x44,0x4E]))
    allFilesMark.append(HLVFileType.magic(name:"pwl", alias: nil, hex: [0xE3,0x82,0x85,0x96]))
    allFilesMark.append(HLVFileType.magic(name:"qbb", alias: nil, hex: [0x45,0x86,0x00,0x00,0x06,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"qdf", alias: nil, hex: [0xAC,0x9E,0xBD,0x8F]))
    allFilesMark.append(HLVFileType.magic(name:"qph", alias: nil, hex: [0x03,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"qt", alias: nil, hex: [0x6D,0x64,0x61,0x74]))
    allFilesMark.append(HLVFileType.magic(name:"qxd", alias: nil, hex: [0x00,0x00,0x4D,0x4D,0x58,0x50,0x52]))
    allFilesMark.append(HLVFileType.magic(name:"ra", alias: nil, hex: [0x2E,0x52,0x4D,0x46,0x00,0x00,0x00,0x12,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"ra", alias: nil, hex: [0x2E,0x72,0x61,0xFD,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"RAR", alias: nil, hex: [0x52,0x61,0x72]))
    allFilesMark.append(HLVFileType.magic(name:"rar", alias: nil, hex: [0x52,0x61,0x72,0x21]))
    allFilesMark.append(HLVFileType.magic(name:"RAW", alias: nil, hex: [0x06,0x05,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"reg", alias: nil, hex: [0x52,0x45,0x47,0x45,0x44,0x49,0x54,0x34]))
    allFilesMark.append(HLVFileType.magic(name:"rgb", alias: nil, hex: [0x01,0xDA,0x01,0x01,0x00,0x03]))
    allFilesMark.append(HLVFileType.magic(name:"RM", alias: nil, hex: [0x2E,0x52,0x4D]))
    allFilesMark.append(HLVFileType.magic(name:"rpm", alias: nil, hex: [0xED,0xAB,0xEE,0xDB]))
    allFilesMark.append(HLVFileType.magic(name:"RTD", alias: nil, hex: [0x43,0x23,0x2B,0x44,0xA4,0x43,0x4D,0xA5,0x48,0x64,0x72]))
    allFilesMark.append(HLVFileType.magic(name:"RTF", alias: nil, hex: [0x7B,0x5C,0x72]))
    allFilesMark.append(HLVFileType.magic(name:"rtf", alias: nil, hex: [0x7B,0x5C,0x72,0x74,0x66]))
    allFilesMark.append(HLVFileType.magic(name:"sav", alias: nil, hex: [0x24,0x46,0x4C,0x32,0x40,0x28,0x23,0x29,0x20,0x53,0x50,0x53,0x53,0x20,0x44,0x41,0x54,0x41,0x20,0x46,0x49,0x4C,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"SBV", alias: nil, hex: [0x46,0x45,0x44,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"SCH", alias: nil, hex: [0x2A,0x76,0x65]))
    allFilesMark.append(HLVFileType.magic(name:"scm", alias: nil, hex: [0x80,0x53,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"SH3", alias: nil, hex: [0x48,0x48,0x47,0x42,0x31]))
    allFilesMark.append(HLVFileType.magic(name:"SHD", alias: nil, hex: [0x4B,0x49,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"sit", alias: nil, hex: [0x53,0x49,0x54,0x21]))
    allFilesMark.append(HLVFileType.magic(name:"sit", alias: nil, hex: [0x53,0x74,0x75,0x66,0x66,0x49,0x74]))
    allFilesMark.append(HLVFileType.magic(name:"sle", alias: nil, hex: [0x3A,0x56,0x45,0x52,0x53,0x49,0x4F,0x4E]))
    allFilesMark.append(HLVFileType.magic(name:"sle", alias: nil, hex: [0x41,0x43,0x76]))
    allFilesMark.append(HLVFileType.magic(name:"SMD", alias: nil, hex: [0x00,0xFF,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"snm", alias: nil, hex: [0x00,0x1E,0x84,0x90,0x00,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"SNP", alias: nil, hex: [0x4D,0x53,0x43,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"sol", alias: nil, hex: [0x00,0xBF]))
    allFilesMark.append(HLVFileType.magic(name:"spl", alias: nil, hex: [0x00,0x00,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"SCR", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"SUB", alias: nil, hex: [0xFF,0xFF,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"SWF", alias: nil, hex: [0x43,0x57,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"SWF", alias: nil, hex: [0x46,0x57,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"syw", alias: nil, hex: [0x41,0x4D,0x59,0x4F]))
    allFilesMark.append(HLVFileType.magic(name:"TAG", alias: nil, hex: [0x00,0x00,0x02]))
    allFilesMark.append(HLVFileType.magic(name:"tar.z", alias: nil, hex: [0x1F,0x9D,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"tga", alias: nil, hex: [0x00,0x00,0x10,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"TGA", alias: nil, hex: [0x00,0x00,0x02]))
    allFilesMark.append(HLVFileType.magic(name:"tga", alias: nil, hex: [0x00,0x00,0x02,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"TLB", alias: nil, hex: [0x4D,0x53,0x46,0x54,0x02,0x00,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"tr1", alias: nil, hex: [0x01,0x10]))
    allFilesMark.append(HLVFileType.magic(name:"TST", alias: nil, hex: [0x00,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"TTF", alias: nil, hex: [0x00,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"ufa", alias: nil, hex: [0x55,0x46,0x41]))
    allFilesMark.append(HLVFileType.magic(name:"VBX", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"VCD", alias: nil, hex: [0x45,0x4E,0x54,0x52,0x59,0x56,0x43,0x44,0x02,0x00,0x00,0x01,0x02,0x00,0x18,0x58]))
    allFilesMark.append(HLVFileType.magic(name:"vcf", alias: nil, hex: [0x42,0x45,0x47,0x49,0x4E,0x3A,0x56,0x43,0x41,0x52,0x44,0x0D,0x0A]))
    allFilesMark.append(HLVFileType.magic(name:"vob", alias: nil, hex: [0x00,0x00,0x01,0xBA]))
    allFilesMark.append(HLVFileType.magic(name:"VXD", alias: nil, hex: [0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"WAV", alias: nil, hex: [0x52,0x49,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"wav", alias: nil, hex: [0x57,0x41,0x56,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"wav", alias: nil, hex: [0x57,0x41,0x56,0x45,0x66,0x6D,0x74]))
    allFilesMark.append(HLVFileType.magic(name:"wb2", alias: nil, hex: [0x00,0x00,0x02,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"wk1", alias: nil, hex: [0x00,0x00,0x02,0x00,0x06,0x04,0x06,0x00,0x08,0x00,0x00,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"wk3", alias: nil, hex: [0x00,0x00,0x1A,0x00,0x00,0x10,0x04,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"wks", alias: nil, hex: [0x0E,0x57,0x4B,0x53]))
    allFilesMark.append(HLVFileType.magic(name:"WMA", alias: nil, hex: [0x30,0x26,0xB2]))
    allFilesMark.append(HLVFileType.magic(name:"wmf", alias: nil, hex: [0x01,0x00,0x09,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"wmf", alias: nil, hex: [0x01,0x00,0x09,0x00,0x00,0x03]))
    allFilesMark.append(HLVFileType.magic(name:"wmf", alias: nil, hex: [0x02,0x00,0x09,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"wmf", alias: nil, hex: [0xD7,0xCD,0xC6,0x9A]))
    allFilesMark.append(HLVFileType.magic(name:"WMV", alias: nil, hex: [0x30,0x26,0xB2]))
    allFilesMark.append(HLVFileType.magic(name:"wp", alias: nil, hex: [0xFF,0x57,0x50,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"wpd", alias: nil, hex: [0xFF,0x57,0x50,0x43]))
    allFilesMark.append(HLVFileType.magic(name:"wpg", alias: nil, hex: [0xFF,0x57,0x50,0x47]))
    allFilesMark.append(HLVFileType.magic(name:"wri", alias: nil, hex: [0x31,0xBE]))
    allFilesMark.append(HLVFileType.magic(name:"WRI", alias: nil, hex: [0x31,0xBE,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"wri", alias: nil, hex: [0x32,0xBE]))
    allFilesMark.append(HLVFileType.magic(name:"ws", alias: nil, hex: [0x1D,0x7D]))
    allFilesMark.append(HLVFileType.magic(name:"XBE", alias: nil, hex: [0x58,0x42,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"xdr", alias: nil, hex: [0x3C]))
    allFilesMark.append(HLVFileType.magic(name:"xls", alias: nil, hex: [0x09,0x02,0x06,0x00,0x00,0x00,0x10,0x00,0xB9,0x04,0x5C,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"xls", alias: nil, hex: [0x09,0x04,0x06,0x00,0x00,0x00,0x10,0x00,0xF6,0x05,0x5C,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"XLS", alias: nil, hex: [0xD0,0xCF,0x11]))
    allFilesMark.append(HLVFileType.magic(name:"xls", alias: nil, hex: [0xD0,0xCF,0x11,0xE0]))
    allFilesMark.append(HLVFileType.magic(name:"XML", alias: nil, hex: [0x3C,0x3F,0x78]))
    allFilesMark.append(HLVFileType.magic(name:"xml", alias: nil, hex: [0x3C,0x3F,0x78,0x6D,0x6C]))
    allFilesMark.append(HLVFileType.magic(name:"xml", alias: nil, hex: [0xFF,0xFE,0x3C,0x00,0x52,0x00,0x4F,0x00,0x4F,0x00,0x54,0x00,0x53,0x00,0x54,0x00,0x55,0x00,0x42,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"XMV", alias: nil, hex: [0x00,0x50,0x01]))
    allFilesMark.append(HLVFileType.magic(name:"XSL", alias: nil, hex: [0xFF,0xFE,0x3C]))
    allFilesMark.append(HLVFileType.magic(name:"xul", alias: nil, hex: [0x72,0x73,0x69,0x6F,0x6E,0x3D,0x22,0x31,0x3C,0x3F,0x78,0x6D,0x6C,0x20,0x76,0x65,0x2E,0x30,0x22,0x3F,0x3E]))
    allFilesMark.append(HLVFileType.magic(name:"z", alias: nil, hex: [0x1F,0x9D]))
    allFilesMark.append(HLVFileType.magic(name:"Z", alias: nil, hex: [0x1F,0x9D,0x8C]))
    allFilesMark.append(HLVFileType.magic(name:"ZIP", alias: nil, hex: [0x50,0x4B,0x03]))
    allFilesMark.append(HLVFileType.magic(name:"zip", alias: nil, hex: [0x50,0x4B,0x30,0x30]))
    allFilesMark.append(HLVFileType.magic(name:"Zip", alias: nil, hex: [0x50,0x4B,0x30,0x30,0x50,0x4B,0x03,0x04]))
    allFilesMark.append(HLVFileType.magic(name:"zoo", alias: nil, hex: [0x5A,0x4F,0x4F,0x20]))
    allFilesMark.append(HLVFileType.magic(name:"aby", alias: ["idx"],hex:[0x41,0x4F,0x4C,0x44,0x42]))
    allFilesMark.append(HLVFileType.magic(name:"bz", alias: ["bz2"],hex:[0x42,0x5A,0x68]))
    allFilesMark.append(HLVFileType.magic(name:"CAB", alias: ["HDR"],hex:[0x49,0x53,0x63,0x28]))
    allFilesMark.append(HLVFileType.magic(name:"CDR", alias: ["DVF"],hex:[0x4D,0x53,0x5F,0x56,0x4F,0x49,0x43,0x45]))
    allFilesMark.append(HLVFileType.magic(name:"CHI", alias: ["CHM"],hex:[0x49,0x54,0x53,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"cru", alias: ["crush"],hex:[0x43,0x52,0x55,0x53,0x48]))
    allFilesMark.append(HLVFileType.magic(name:"gz", alias: ["tar","tgz"],hex:[0x1F,0x8B]))
    allFilesMark.append(HLVFileType.magic(name:"gz", alias: ["tgz"],hex:[0x1F,0x8B,0x08]))
    allFilesMark.append(HLVFileType.magic(name:"htm", alias: ["html"],hex:[0x3C,0x21,0x44,0x4F,0x43,0x54]))
    allFilesMark.append(HLVFileType.magic(name:"htm", alias: ["html"],hex:[0x3C,0x48,0x54,0x4D,0x4C,0x3E]))
    allFilesMark.append(HLVFileType.magic(name:"htm", alias: ["html"],hex:[0x3C,0x68,0x74,0x6D,0x6C,0x3E]))
    allFilesMark.append(HLVFileType.magic(name:"jpg", alias: ["jpeg"],hex:[0xFF,0xD8,0xFF]))
    allFilesMark.append(HLVFileType.magic(name:"m4a", alias: ["m4v"],hex:[0x00,0x00,0x00,0x20,0x66,0x74,0x79,0x70,0x4D,0x34,0x41,0x20,0x00,0x00,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"MID", alias: ["MIDI"],hex:[0x4D,0x54,0x68,0x64]))
    allFilesMark.append(HLVFileType.magic(name:"mpg", alias: ["mpeg"],hex:[0x00,0x00,0x01,0xB3]))
    allFilesMark.append(HLVFileType.magic(name:"nsf", alias: ["ntf"],hex:[0x1A,0x00,0x00,0x03,0x00,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"org", alias: ["pfc"],hex:[0x41,0x4F,0x4C,0x56,0x4D,0x31,0x30,0x30]))
    allFilesMark.append(HLVFileType.magic(name:"pdf", alias: ["fdf"],hex:[0x25,0x50,0x44,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"ra", alias: ["ram"],hex:[0x2E,0x72,0x61,0xFD]))
    allFilesMark.append(HLVFileType.magic(name:"rm", alias: ["rmvb"],hex:[0x2E,0x52,0x4D,0x46]))
    allFilesMark.append(HLVFileType.magic(name:"tar", alias: ["cpio"],hex:[0x30,0x37,0x30,0x37,0x30,0x37]))
    allFilesMark.append(HLVFileType.magic(name:"TIF", alias: ["TIFF"],hex:[0x49,0x20,0x49]))
    allFilesMark.append(HLVFileType.magic(name:"tif", alias: ["tiff"],hex:[0x49,0x49,0x2A]))
    allFilesMark.append(HLVFileType.magic(name:"tif", alias: ["tiff"],hex:[0x49,0x49,0x2A,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"TIF", alias: ["TIFF"],hex:[0x4D,0x4D,0x00,0x2A]))
    allFilesMark.append(HLVFileType.magic(name:"tif", alias: ["tiff"],hex:[0x4D,0x4D,0x2A]))
    allFilesMark.append(HLVFileType.magic(name:"TIF", alias: ["TIFF"],hex:[0x4D,0x4D,0x00,0x2B]))
    allFilesMark.append(HLVFileType.magic(name:"wk1", alias: ["wks"],hex:[0x20,0x00,0x60,0x40,0x60]))
    allFilesMark.append(HLVFileType.magic(name:"wk4", alias: ["wk5"],hex:[0x00,0x00,0x1A,0x00,0x02,0x10,0x04,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"asf", alias: ["wma","wmv"],hex:[0x30,0x26,0xB2,0x75,0x8E,0x66,0xCF,0x11,0xA6,0xD9,0x00,0xAA,0x00,0x62,0xCE,0x6C]))
    allFilesMark.append(HLVFileType.magic(name:"BZ2", alias: ["TAR.BZ2","TBZ2","TB2"],hex:[0x42,0x5A,0x68]))
    allFilesMark.append(HLVFileType.magic(name:"COM", alias: ["DLL","DRV","EXE","PIF","QTS","QTX","SYS"],hex:[0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"dot", alias: ["ppt","xla","ppa","pps","pot","msi","sdw","db"],hex:[0xD0,0xCF,0x11,0xE0]))
    allFilesMark.append(HLVFileType.magic(name:"doc", alias: ["dot","xls","xlt","xla","ppt","apr,;ppa","pps","pot","msi","sdw","db"],hex:[0xD0,0xCF,0x11,0xE0,0xA1,0xB1,0x1A,0xE1]))
    allFilesMark.append(HLVFileType.magic(name:"exe", alias: ["dll","drv","vxd","sys","ocx","vbx"],hex:[0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"exe", alias: ["dll","drv","vxd","sys","ocx","vbx"],hex:[0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"exe", alias: ["com","386","ax","acm","sys","dll","drv","flt","fon","ocx","scr","lrc","vxd","cpl","x32"],hex:[0x4D,0x5A]))
    allFilesMark.append(HLVFileType.magic(name:"EXE", alias: ["DLL","OCX","OLB","IMM","IME"],hex:[0x4D,0x5A,0x90]))
    allFilesMark.append(HLVFileType.magic(name:"jpg", alias: ["jpe","jpeg"],hex:[0xFF,0xD8,0xFF,0xE0,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"jpg", alias: ["jpe","jpeg"],hex:[0xFF,0xD8,0xFF,0xFE,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"mdb", alias: ["mda","mde","mdt"],hex:[0x53,0x74,0x61,0x6E,0x64,0x61,0x72,0x64,0x20,0x4A]))
    allFilesMark.append(HLVFileType.magic(name:"sly", alias: ["srt","slt"],hex:[0x53,0x52,0x01,0x00]))
    allFilesMark.append(HLVFileType.magic(name:"zip", alias: ["jar","zipx"],hex:[0x50,0x4B,0x03,0x04]))
    
    allFilesMark.sort { l, r in
      guard case let .magic(_, _, lhex) = l else {
        return true
      }
      guard case let .magic(_, _, rhex) = r else {
        return true
      }
      
      for i in 0...100 {
        if lhex.count > i && rhex.count > i {
          if lhex[i] != rhex[i] {
            return lhex[i] > rhex[i]
          }
        } else {
          if lhex.count > i {
            return true
          } else {
            return false
          }
        }
      }
      return true
    }
  }

}
